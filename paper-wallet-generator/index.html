<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMMOcoin Paper Wallet Generator</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d3748 100%);
            color: #e2e8f0;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 18px;
            color: #a0aec0;
            margin-bottom: 30px;
        }

        .security-notice {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid #ef4444;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .security-notice h3 {
            color: #ef4444;
            margin: 0 0 10px 0;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
        }

        .control-group h3 {
            margin: 0 0 15px 0;
            color: #ffd700;
        }

        button {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #1a1a1a;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.3);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        input, select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #e2e8f0;
            padding: 10px;
            border-radius: 5px;
            width: 100%;
            margin-bottom: 10px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #ffd700;
        }

        .wallet-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .wallet-card {
            background: white;
            color: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .wallet-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
        }

        .wallet-header {
            position: relative;
            z-index: 1;
            text-align: center;
            margin-bottom: 20px;
            padding-top: 10px;
        }

        .wallet-title {
            font-size: 24px;
            font-weight: bold;
            color: #1a1a1a;
            margin: 0;
        }

        .wallet-subtitle {
            font-size: 14px;
            color: #666;
            margin: 5px 0 0 0;
        }

        .qr-code {
            text-align: center;
            margin: 20px 0;
        }

        .address-section {
            margin: 20px 0;
        }

        .address-label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .address-value {
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            word-break: break-all;
            font-size: 12px;
            border: 1px solid #e9ecef;
        }

        .print-instructions {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .entropy-display {
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            word-break: break-all;
            font-size: 12px;
            margin-top: 10px;
        }

        @media print {
            body {
                background: white;
                color: black;
            }

            .container {
                background: none;
                box-shadow: none;
            }

            .controls, .security-notice, .print-instructions {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">AMMOcoin</div>
            <div class="subtitle">Secure Paper Wallet Generator v1.1.0</div>
        </div>

        <div class="security-notice">
            <h3>üîí SECURITY NOTICE</h3>
            <p><strong>For maximum security:</strong></p>
            <ul>
                <li>Disconnect from the internet before generating wallets</li>
                <li>Use this tool on a clean, offline computer</li>
                <li>Print immediately and securely delete any digital copies</li>
                <li>Store printed wallets in a fireproof, secure location</li>
                <li>Never enter your private key online unless you're importing the full balance</li>
            </ul>
        </div>

        <div class="controls">
            <div class="control-group">
                <h3>Generate Wallets</h3>
                <label>Number of wallets:</label>
                <select id="walletCount">
                    <option value="1">1 Wallet</option>
                    <option value="2">2 Wallets</option>
                    <option value="3">3 Wallets</option>
                    <option value="4">4 Wallets</option>
                    <option value="5">5 Wallets</option>
                </select>
                <button onclick="generateWallets()">Generate New Wallets</button>
            </div>

            <div class="control-group">
                <h3>Entropy Options</h3>
                <label>Additional Entropy (optional):</label>
                <input type="text" id="customEntropy" placeholder="Type random characters for extra security">
                <button onclick="addMouseEntropy()" id="mouseEntropyBtn">Add Mouse Entropy</button>
                <div id="entropyDisplay" class="entropy-display" style="display: none;"></div>
            </div>

            <div class="control-group">
                <h3>Actions</h3>
                <button onclick="printWallets()">üñ®Ô∏è Print Wallets</button>
                <button onclick="clearWallets()">üóëÔ∏è Clear All</button>
                <button onclick="validateAddresses()">‚úÖ Validate Addresses</button>
            </div>
        </div>

        <div id="walletContainer" class="wallet-display"></div>

        <div class="print-instructions">
            <h3>üìã Instructions</h3>
            <ol>
                <li><strong>Public Address:</strong> Use this to receive AMMOcoin. Share this freely.</li>
                <li><strong>Private Key:</strong> Keep this SECRET. Anyone with this key can spend your AMMOcoin.</li>
                <li><strong>To use your wallet:</strong> Import the private key into an AMMOcoin wallet application.</li>
                <li><strong>Backup:</strong> Store multiple copies in secure, separate locations.</li>
            </ol>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js"></script>
    <script>
        // AMMOcoin-specific configuration
        const NETWORK = {
            version: 0x17, // AMMOcoin pubkey address version (A addresses)
            privateKeyVersion: 0x97, // AMMOcoin private key version
            scriptVersion: 0x7D // AMMOcoin script address version
        };

        let mouseEntropy = '';
        let isCollectingEntropy = false;

        // Secure random number generation using Web Crypto API
        function getSecureRandom(length) {
            const array = new Uint8Array(length);
            crypto.getRandomValues(array);
            return Array.from(array);
        }

        // Base58 encoding/decoding
        const BASE58_ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';

        function base58Encode(bytes) {
            if (bytes.length === 0) return '';

            // Convert to big integer
            let num = BigInt('0x' + Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join(''));

            let result = '';
            while (num > 0) {
                result = BASE58_ALPHABET[num % 58n] + result;
                num = num / 58n;
            }

            // Add leading zeros
            for (let i = 0; i < bytes.length && bytes[i] === 0; i++) {
                result = '1' + result;
            }

            return result;
        }

        function base58Decode(str) {
            if (str.length === 0) return [];

            let num = BigInt(0);
            for (let char of str) {
                const index = BASE58_ALPHABET.indexOf(char);
                if (index === -1) throw new Error('Invalid base58 character');
                num = num * 58n + BigInt(index);
            }

            let hex = num.toString(16);
            if (hex.length % 2) hex = '0' + hex;

            const bytes = [];
            for (let i = 0; i < hex.length; i += 2) {
                bytes.push(parseInt(hex.substr(i, 2), 16));
            }

            // Add leading zeros
            for (let i = 0; i < str.length && str[i] === '1'; i++) {
                bytes.unshift(0);
            }

            return bytes;
        }

        // SHA256 double hash
        function sha256d(data) {
            const hash1 = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(data));
            const hash2 = CryptoJS.SHA256(hash1);
            return Array.from(hash2.words.map(word => [
                (word >>> 24) & 0xff,
                (word >>> 16) & 0xff,
                (word >>> 8) & 0xff,
                word & 0xff
            ]).flat());
        }

        // Generate private key from entropy
        function generatePrivateKey() {
            const customEntropy = document.getElementById('customEntropy').value;
            const additionalEntropy = mouseEntropy + customEntropy + Date.now().toString();

            // Combine secure random with additional entropy
            const secureRandom = getSecureRandom(32);
            const entropyBytes = CryptoJS.enc.Utf8.parse(additionalEntropy);
            const combined = CryptoJS.lib.WordArray.create(secureRandom).concat(entropyBytes);
            const hash = CryptoJS.SHA256(combined);

            return Array.from(hash.words.map(word => [
                (word >>> 24) & 0xff,
                (word >>> 16) & 0xff,
                (word >>> 8) & 0xff,
                word & 0xff
            ]).flat());
        }

        // Generate public key from private key (simplified - in production use secp256k1)
        function generatePublicKey(privateKey) {
            // This is a simplified version. In production, use proper secp256k1 implementation
            const hash = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(privateKey));
            return Array.from(hash.words.map(word => [
                (word >>> 24) & 0xff,
                (word >>> 16) & 0xff,
                (word >>> 8) & 0xff,
                word & 0xff
            ]).flat()).slice(0, 33); // Compressed public key format
        }

        // Generate AMMOcoin address from public key
        function generateAddress(publicKey) {
            // Hash160 (RIPEMD160(SHA256(pubkey)))
            const sha256Hash = CryptoJS.SHA256(CryptoJS.lib.WordArray.create(publicKey));
            const ripemd160Hash = CryptoJS.RIPEMD160(sha256Hash);
            const hash160 = Array.from(ripemd160Hash.words.map(word => [
                (word >>> 24) & 0xff,
                (word >>> 16) & 0xff,
                (word >>> 8) & 0xff,
                word & 0xff
            ]).flat()).slice(0, 20);

            // Add version byte
            const versionedHash = [NETWORK.version, ...hash160];

            // Calculate checksum
            const checksum = sha256d(versionedHash).slice(0, 4);

            // Combine and encode
            const fullHash = [...versionedHash, ...checksum];
            return base58Encode(fullHash);
        }

        // Generate WIF (Wallet Import Format) private key
        function generateWIF(privateKey) {
            const versionedKey = [NETWORK.privateKeyVersion, ...privateKey, 0x01]; // 0x01 for compressed
            const checksum = sha256d(versionedKey).slice(0, 4);
            const fullKey = [...versionedKey, ...checksum];
            return base58Encode(fullKey);
        }

        // Generate a complete wallet
        function generateWallet() {
            const privateKey = generatePrivateKey();
            const publicKey = generatePublicKey(privateKey);
            const address = generateAddress(publicKey);
            const wif = generateWIF(privateKey);

            return {
                address: address,
                privateKey: Array.from(privateKey).map(b => b.toString(16).padStart(2, '0')).join(''),
                wif: wif,
                publicKey: Array.from(publicKey).map(b => b.toString(16).padStart(2, '0')).join('')
            };
        }

        // Generate multiple wallets
        async function generateWallets() {
            const count = parseInt(document.getElementById('walletCount').value);
            const container = document.getElementById('walletContainer');
            container.innerHTML = '';

            for (let i = 0; i < count; i++) {
                const wallet = generateWallet();
                await createWalletCard(wallet, i + 1);
            }
        }

        // Create wallet display card
        async function createWalletCard(wallet, index) {
            const container = document.getElementById('walletContainer');

            const card = document.createElement('div');
            card.className = 'wallet-card';
            card.innerHTML = `
                <div class="wallet-header">
                    <h2 class="wallet-title">AMMOcoin Paper Wallet #${index}</h2>
                    <p class="wallet-subtitle">Keep this private key secret and secure</p>
                </div>

                <div class="address-section">
                    <div class="address-label">Public Address (Share freely):</div>
                    <div class="address-value">${wallet.address}</div>
                    <div class="qr-code" id="qr-address-${index}"></div>
                </div>

                <div class="address-section">
                    <div class="address-label">Private Key (Keep SECRET):</div>
                    <div class="address-value">${wallet.wif}</div>
                    <div class="qr-code" id="qr-private-${index}"></div>
                </div>
            `;

            container.appendChild(card);

            // Generate QR codes
            try {
                await QRCode.toCanvas(document.createElement('canvas'), wallet.address, {
                    width: 128,
                    height: 128,
                    margin: 1
                }).then(canvas => {
                    document.getElementById(`qr-address-${index}`).appendChild(canvas);
                });

                await QRCode.toCanvas(document.createElement('canvas'), wallet.wif, {
                    width: 128,
                    height: 128,
                    margin: 1
                }).then(canvas => {
                    document.getElementById(`qr-private-${index}`).appendChild(canvas);
                });
            } catch (error) {
                console.error('QR Code generation failed:', error);
            }
        }

        // Add mouse entropy
        function addMouseEntropy() {
            const btn = document.getElementById('mouseEntropyBtn');
            const display = document.getElementById('entropyDisplay');

            if (!isCollectingEntropy) {
                isCollectingEntropy = true;
                mouseEntropy = '';
                btn.textContent = 'Move mouse randomly... (10s)';
                btn.disabled = true;
                display.style.display = 'block';

                let timeLeft = 10;
                const timer = setInterval(() => {
                    timeLeft--;
                    btn.textContent = `Move mouse randomly... (${timeLeft}s)`;
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        isCollectingEntropy = false;
                        btn.textContent = 'Add Mouse Entropy';
                        btn.disabled = false;
                        display.textContent = `Entropy collected: ${mouseEntropy.length} characters`;
                    }
                }, 1000);

                document.addEventListener('mousemove', collectMouseEntropy);
                setTimeout(() => {
                    document.removeEventListener('mousemove', collectMouseEntropy);
                }, 10000);
            }
        }

        function collectMouseEntropy(event) {
            if (isCollectingEntropy) {
                mouseEntropy += event.clientX.toString() + event.clientY.toString() + Date.now().toString();
            }
        }

        // Validate addresses (basic format check)
        function validateAddresses() {
            const cards = document.querySelectorAll('.wallet-card');
            let allValid = true;

            cards.forEach(card => {
                const addressElement = card.querySelector('.address-value');
                const address = addressElement.textContent;

                try {
                    const decoded = base58Decode(address);
                    if (decoded.length !== 25 || decoded[0] !== NETWORK.version) {
                        throw new Error('Invalid address format');
                    }

                    const hash = decoded.slice(0, 21);
                    const checksum = decoded.slice(21);
                    const calculatedChecksum = sha256d(hash).slice(0, 4);

                    if (!checksum.every((byte, i) => byte === calculatedChecksum[i])) {
                        throw new Error('Invalid checksum');
                    }

                    addressElement.style.borderColor = '#28a745';
                } catch (error) {
                    addressElement.style.borderColor = '#dc3545';
                    allValid = false;
                }
            });

            alert(allValid ? 'All addresses are valid!' : 'Some addresses failed validation!');
        }

        // Print wallets
        function printWallets() {
            window.print();
        }

        // Clear all wallets
        function clearWallets() {
            if (confirm('Are you sure you want to clear all wallets? Make sure you have saved/printed them first!')) {
                document.getElementById('walletContainer').innerHTML = '';
                document.getElementById('customEntropy').value = '';
                mouseEntropy = '';
            }
        }

        // Initialize with one wallet
        document.addEventListener('DOMContentLoaded', function() {
            // Show initial entropy warning
            setTimeout(() => {
                alert('Welcome to AMMOcoin Paper Wallet Generator!\\n\\nFor maximum security:\\n1. Disconnect from the internet\\n2. Add additional entropy using mouse movement\\n3. Print wallets immediately\\n4. Clear browser data after use');
            }, 1000);
        });
    </script>
</body>
</html>